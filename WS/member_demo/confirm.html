<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>王品電子菁英</title>
    <link rel="stylesheet" type="text/css" href="css/pace.css"><script type="text/javascript" src="js/pace.js"></script>
    <!--[if lt IE 10]>
    <script>alert('請使用IE10以上或Ghrome瀏覽器閱覽本站哦，謝謝');</script>    
    <![endif]-->
    
      <script src="https://code.jquery.com/jquery-1.12.4.js" 
  integrity="sha256-Qw82+bXyGq6MydymqBxNPYTaUXXq7c8v3CwiYwLLNXU="
  crossorigin="anonymous"></script>
    <script src="js/main.js"></script>
    <link rel="stylesheet" href="css/apply.css">
    <link href="css/bootstrap-material-design.min.css" rel="stylesheet">
</head>

<body>
    <header class="p1"></header>
    <div class="slider-wrapper theme-default">
        <div id="slider" class="nivoSlider"></div>
    </div>
    <div class="slideTitle"></div>
    <div class="content">
        <div class="t1">
            <i class="demo-icon icon-member">&#xe800;</i>
            <hr> 申請電子菁英會員
        </div>
        <div class="box confirm">
            <div class="container card checkCode">
                <h2>請輸入您手機收到的認證碼，完成驗證程序：</h2>
                <p>若您的手機於5分鐘內尚未收到驗證碼簡訊，請您選擇補發手機驗證碼。</p>
                        <div id="lblmobile" class="form-group">
                            <label for="i5" class="control-label">手機號碼</label>
                            <input type="number" class="form-control" id="mobile">  
                        </div>
                        <div class="form-group label-floating">
                            <label for="i5" class="control-label">手機驗證碼</label>
                            <input type="number" class="form-control" id="acode">                                                       
                        </div>
                                                    
                            <button class="submit" onclick="return chk();">確認送出</button>
                            <button class="reSend" onclick="resend();" id="btnResend">補發手機驗證碼</button>
                                                    
                            <!-- <button class="submit" onclick="test();" id="test">test</button> -->

                  <div class="LT"></div>
                  <div class="RB"></div>
            </div>

        </div>
    </div>
    <div class="footer"></div>
    <script src="js/material.min.js"></script>
    <script src="WPJS/base.js"></script>
    <script src="WPJS/member.js"></script>

    <script>
    $(function() {

        if(typeof(loadSessionStorage("memp"))!="undefined" && loadSessionStorage("memp")!='')
        {
            $('#lblmobile').css('display','none');
        }

         if(getUrlParameter('memp')!='' && getUrlParameter('memp')!=undefined && getUrlParameter('cxc')!='' && getUrlParameter('cxc')!=undefined)
        {
             $('#lblmobile').css('display','none');
             saveSessionStorage("memp",getUrlParameter('memp'));
             $('#acode').val(getUrlParameter('cxc'));
              if(getUrlParameter('m3mfrom')!=''&&getUrlParameter('m3mfrom')!=undefined)
              {
                saveSessionStorage("m3mfrom",getUrlParameter('m3mfrom'));
              }
        }

        if(getUrlParameter('mobile')=='')
        {
            if(typeof(loadSessionStorage("user_id"))=="undefined" || loadSessionStorage("user_id")=='')
            {
                window.location.href="application.html";
            }
        }
        $.material.init();       

        if(getUrlParameter('mobile')!='')
        {
            $('#mobile').val(getUrlParameter('mobile'));
            $('#acode').focus();
        }
        
    });

    function chk()
    {
        if(typeof(loadSessionStorage("memp"))=="undefined" || loadSessionStorage("memp")=='')
        {
            if(!isValidMobile($('#mobile').val()) )
            {   $('#mobile').focus(); sweetAlert("Oops...", '手機號碼不正確', "error");
                $('.mobileForm').addClass('has-error');
             return false; 
                   
            } 
        }
        if($('#acode').val()=='')
        {
            $('#acode').focus(); sweetAlert("Oops...", '請填入驗證碼', "error");
            return false;
        }
        api_sendcon($('#acode').val(),$('#mobile').val());
    }

    function resend()
    {
        if(!isValidMobile($('#mobile').val()) )
            {   $('#mobile').focus(); sweetAlert("Oops...", '手機號碼不正確', "error");
                $('.mobileForm').addClass('has-error');
             return false;                    
            } 
        $('#btnResend').attr('disabled',true);
        countSec();                
    }

   
    var waitsec=60;
    x=0;
    function countSec()
    {　
        if(typeof(loadSessionStorage("ss"))!="undefined" || loadSessionStorage("ss")>0)
        {
            waitsec=loadSessionStorage("ss");
        }
        else
        {
            api_resendcode($('#mobile').val());
        }
        waitsec = waitsec-1
        saveSessionStorage('ss',waitsec);
        z =waitsec % 60
        $("#btnResend").html('請等待'+z+'秒後才能再度發送');
        if(waitsec==0)    
        { 
            waitsec=60;    
            $("#btnResend").html('補發手機驗證碼');
            $("#btnResend").attr('disabled',false);
            return;
        }
    　 setTimeout("countSec()", 1000)
    }

    </script>
</body>

</html>
